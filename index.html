<!DOCTYPE html>

<head>

	<title>Testing</title>

	<script> // Check URL, load jQuery or Zepto
		var script=document.createElement("script");0>window.location.href.indexOf("zepto")?
		script.src="http://code.jquery.com/jquery-1.10.2.js":
		script.src="http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.js";
		document.write(script.outerHTML);
	</script>

	<style>

		body {
			width: 400px;
			max-width: 100%;
			margin: 100px auto;
		}

		.noUi-target {
			margin: 80px;
		}
		.noUi-vertical {
			height: 150px;
		}

		section {
			border-bottom: 2px solid #888;
			margin-bottom: 80px;
			padding-bottom: 40px;
		}

		.tooltip {
			display: none;
			position: absolute;
			border: 1px solid #D9D9D9;
			font: 400 12px/12px Arial;
			border-radius: 3px;
			top: 40px;
			padding: 5px;
			left: 17px;
		}
		.tooltip.top {
			top: auto;
			bottom: 40px;
		}
		.noUi-active .tooltip {
			display: block;
		}

	</style>

	<link href="jquery.nouislider.css" rel="stylesheet">
	<script src="jquery.nouislider.js"></script>

	<script>
	var Link = $.noUiSlider.Link;
	</script>

	<link href="http://code.jquery.com/qunit/qunit-1.12.0.css" rel="stylesheet">
	<script src="http://code.jquery.com/qunit/qunit-1.12.0.js"></script>

	<style>
/*
		#qunit-fixture {
			position: static;
			width: auto;
			height: auto;
		}
*/
	</style>

</head>

<!-- TODO

	- Port other functional tests to unit tests
	- Add asyncTest, stop() hack
	- Add tests for events
	- Add tests for event emitting

-->

<body>

	<div id="qunit"></div>
	<div id="qunit-fixture"></div>

	<script>
		var Q = $("#qunit-fixture");
	</script>

<script>

	test( "Generation of named inputs", function(){

		Q.html('\
			<form>\
				<div class="slider" id="slidera"></div>\
				<div class="slider" id="sliderb"></div>\
				<div class="slider" id="sliderc"></div>\
			</form>\
		');

		Q.find(".slider").noUiSlider({
			  range: {
				'min': [   0 ],
				'max': [ 100 ]
			}
			,start: [ 20, 80 ]
			,serialization: {
				 lower: [ new Link('lower') ]
				,upper: [ new Link('upper') ]
			}
		});

		$("#slidera").val([50, 61]);
		$("#sliderb").val([51, 62]);
		$("#sliderc").val([52, 63]);

		var inputs = Q.find('input');

		equal( inputs.length, 6, "Generated all inputs" );

		equal( $(inputs[0]).val(), '50.00' );
		equal( $(inputs[1]).val(), '61.00' );
		equal( $(inputs[2]).val(), '51.00' );
		equal( $(inputs[3]).val(), '62.00' );
		equal( $(inputs[4]).val(), '52.00' );
		equal( $(inputs[5]).val(), '63.00' );

	});

	test( "Shared link element", function(){

		Q.html('\
			<div class="slider" id="slidera"></div>\
			<div class="slider" id="sliderb"></div>\
			<span id="slider-span"></span>\
		');

		var span = $('#slider-span');

		var LinkEl =
			new Link( span, false, {
				 mark: ','
				,decimals: 1
				,thousand: '.'
				,encoder: function( decoded ){
					return decoded * 10000;
				}
				,decoder: function( encoded ){
					return encoded / 10000;
				}
			});

		$("#slidera, #sliderb").noUiSlider({
			 range: {
				'min': [ -20 ],
				'max': [  20 ]
			}
			,start: [ 0, 10 ]
			,behaviour: 'drag'
			,connect: true
			,serialization: {
				lower: [ LinkEl ]
			}
		});

		$("#sliderb").val( 1 );

		deepEqual( $("#slidera").val(), ['0.00', '10.00'] );
		equal( span.html(), '10.000,0' );

	});

	test( "Serialization and formatting options", function(){

		Q.html('\
			<div class="slider" id="slider"></div>\
			<input id="inputChange">\
			<input id="inputVal">\
			<span id="sliderspan"></span>\
		');

		function placeTooltip(value){
			$(this).text(value);
		}

		var tooltipLink =
			new Link( '-tooltip-<div class="tooltip"/>', function( value, handle, slider ){

				ok( $("#slider").is( slider ) );
				ok( handle.hasClass('noUi-handle') );

			}, {
				 decimals: 6
				,prefix: '#'
				,negativeBefore: '!'
				,negative: ''
			});

		var changeLink =
			new Link( $("#inputChange"), false, {
				 mark: '.'
				,thousand: ','
				,prefix: '$'
				,postfix: ' p.p.'
				,decimals: 3
				,negativeBefore: '-'
				,negative: ''
				,encoder: function( a ){
					return a * 1E7;
				}
				,decoder: function( a ){
					return a / 1E7;
				}
			});

		var valLink =
			new Link( $("#inputVal"), 'val' );

		$("#slider").noUiSlider({
			 range: {
				'min': [ 0.001 ],
				'max': [ 0.003 ]
			}
			,start: [ 0, 0.002 ]
			,connect: true
			,behaviour: 'drag'
			,serialization: {
				 lower: [ tooltipLink, changeLink ]
				,upper: [ valLink ]
				,format: {
					decimals: 5
				}
			}
		});

		$("#inputChange").val( "15000" ).trigger('change');

		equal( $("#inputChange").val(), "$15,000.000 p.p.", "Testing interpretation of improper data" );

		$("#inputVal").val( 3 );

		equal( $("#inputVal").val(), "3" );

		$("#inputVal").trigger("change");

		equal ( $("#inputVal").val(), "3", "Input doesn't respond to change events." );

		deepEqual( $("#slider").val(), ["0.00150", "0.00200"] );

	});

</script>

<section>



</section>

<section>

	<div class="Fslider2" id="Fslider2a"></div>
	<span id="Fslider2aspan"></span>

	<div class="Fslider2" id="Fslider2b"></div>
	<span id="Fslider2bspan"></span>

	<button>Lock</button>

	<script>

		var Lock = false, values = [60, 60];

		$("button").click(function(){
			Lock = !Lock;
		});

		function Sync ( value, handle, slider ) {
			if ( !Lock ) return;

			var nr = $("#Fslider2a").is( $(this) ) ? 0 : 1;

			value -= ( values[Math.abs(nr-1)] - values[nr] );

			$(this).val( value, false, false, true );
		}

		function Store ( ) {
			values[0] = Number($("#Fslider2a").val());
			values[1] = Number($("#Fslider2b").val());
		}

		$("#Fslider2a").noUiSlider({
			range: {
				'min': [  50 ],
				'max': [ 100 ]
			},
			handles: 1,
			start: [ 60 ],
			serialization: {
				lower: [
					new Link( $("#Fslider2b"), Sync, false, true ),
					new Link( $("#Fslider2aspan") )
				]
			},
		});

		$("#Fslider2b").noUiSlider({
			range: {
				'min': [  50 ],
				'max': [ 100 ]
			},
			handles: 1,
			start: [ 80 ],
			serialization: {
				lower: [
					new Link( $("#Fslider2a"), Sync, false, true ),
					new Link( $("#Fslider2bspan") )
				]
			}
		});

		$(".Fslider2").on('set', Store);

	</script>

</section>



<!--
<section>

	<div class="slider3" id="slider3"></div>

	<span id="slider3span"></span>

	<script>

		$("#slider3").noUiSlider({
			 range: [ -10, 0 ]
			,start: [ 0, 0 ]
			,handles: 1
			,behaviour: 'extend-tap'
			,connect: 'lower'
			,serialization: {
				 lower: [	new Link(function( value ){
								$("#slider3span").html( value );
							})
						]
			}
		});

	</script>

</section>

	<script>

		$("#slider5b").noUiSlider({
			 range: [ 0, 10000 ]
			,start: [ 500, 4000 ]
			,step: true
			,stepping: {
				  '0%': [    0, 100 ]
				,'10%': [ 1000, 500 ]
				,'50%': [ 5000 ]
			}
			,serialization: {
				 lower: [
					 new Link ( $('#slider5bspan1a') )
					,new Link ( $('#slider5bspan1b'), writeLeft )
				 ]
				,upper: [
					 new Link ( $('#slider5bspan2a') )
					,new Link ( $('#slider5bspan2b'), writeLeft )
				 ]
			}
		});

	</script>

</section>

<section>

	<div class="slider6" id="slider6"></div>
	<span id="slider6span"></span>

	<script>

		$("#slider6").noUiSlider({
			 range: [0, 100]
			,start: [20, 80]
			,step: 10
			,handles: 1
			,connect: 'lower'
			,serialization: {
				 lower: [ new Link($("#slider6span")) ]
			}
		});

	</script>

</section>

<section>

	<div class="slider7a" id="slider7a"></div>
	<span id="slider7aspan"></span>

	<div class="slider7b" id="slider7b"></div>
	<span id="slider7bspan1"></span>
	<span id="slider7bspan2"></span>

	<script>

		$("#slider7a").noUiSlider({
			 range: [0, 200]
			,start: [20, 80]
			,step: 15
			,handles: 1
			,connect: 'upper'
			,direction: 'rtl'
			,serialization: {
				 lower: [ new Link($("#slider7aspan")) ]
			}
		});

	</script>

	<script>

		$("#slider7b").noUiSlider({
			 range: [0, 200]
			,start: [20, 80]
			,step: 15
			,handles: 2
			,connect: true
			,direction: 'rtl'
			,serialization: {
				 lower: [ new Link($("#slider7bspan1")) ]
				,upper: [ new Link($("#slider7bspan2")) ]
			}
		});

	</script>

</section>

<section>

	<div class="slider8" id="slider8"></div>
	<span id="slider8span"></span>

	<script>

		$("#slider8").noUiSlider({
			 range: [100, 150]
			,start: [110, 140]
			,step: 10
			,behaviour: 'drag-fixed'
			,orientation: 'vertical'
			,handles: 2
			,connect: true
			,serialization: {
				 lower: [ new Link($("#slider8span")) ]
			}
		});

	</script>


</section>

</body>
